import{M as ue}from"./MainLayout-cmQcMttl.js";import{a as me,T as J,_ as ge}from"./_plugin-vue_export-helper-C_lUuKz4.js";import{s as q}from"./sites-CZD5WQuG.js";import{d as K,m,F as pe,c,w as a,b as n,a as l,h as r,y as g,v as s,g as i,H as U,x as h,i as z,a2 as b,a3 as v,a4 as f,s as V,I as A,J as L,t as p,a5 as E,j as P,a6 as R,a7 as $,a8 as be,a9 as D,aa as ve,S as N,n as Q,N as fe,O as j,P as W,e as ce,R as xe,ab as M,o as u,D as ye,C as X,f as we,ac as k}from"./index-BaQgaqTq.js";const Ve={class:"d-flex justify-space-between align-center mb-4",style:{height:"48px"}},ke={class:"d-flex align-center"},Ce={class:"text-h6 font-weight-bold m-0"},Te={class:"d-flex align-center gap-2"},Fe={class:"d-flex h-100 bg-grey-lighten-4",style:{margin:"0 -32px -32px -32px",height:"calc(100vh - 112px)"}},Se={class:"bg-white border-r d-flex flex-column",style:{width:"340px","overflow-y":"auto"}},Ue=["onClick"],he={class:"ml-3"},ze={class:"text-body-2 font-weight-bold text-truncate",style:{"max-width":"140px"}},Ae={class:"text-caption text-grey"},Le={class:"flex-grow-1 d-flex flex-column align-center justify-center bg-grey-lighten-3 pa-8 overflow-hidden relative"},Pe=["src"],Be={class:"d-flex gap-2 mb-6"},Ie={class:"flex-grow-1 d-flex flex-column align-center justify-center text-center px-4"},Ee={class:"preview-products d-flex justify-center gap-2 px-4 pb-3"},Re={class:"d-flex align-center mb-1"},$e={class:"text-body-1 font-weight-bold"},De={class:"text-caption text-grey-darken-1"},Ne=K({__name:"BuilderView",setup(je){const o=me(),B=m(!1),I=m(!1),C=m(""),x=m("desktop"),O=m(["general","products"]),T=m(null),F=m("/shop/preview"),y=m(!1),w=m("all"),Y=[{label:"Все шаблоны",value:"all"},{label:"Минимализм",value:"minimal"},{label:"Современные",value:"modern"},{label:"Классика",value:"classic"},{label:"Тёмные",value:"dark"}],Z=pe(()=>w.value==="all"?J:J.filter(d=>d.category===w.value)),_=()=>{y.value=!0},ee=d=>{o.applyTheme(d),y.value=!1,H()},le=d=>{switch(d){case"minimal":return"grey";case"modern":return"purple";case"classic":return"blue";case"dark":return"black";default:return"grey"}},te=d=>{switch(d){case"minimal":return"Минимализм";case"modern":return"Модерн";case"classic":return"Классика";case"dark":return"Тёмная";default:return d}},ae=d=>({backgroundColor:d.settings.backgroundColor}),oe=m([{id:1,name:"Футболка Basic",price:1200,image:""},{id:2,name:"Кепка Brand",price:800,image:""},{id:3,name:"Худи Oversize",price:3500,image:""}]),se=d=>{F.value=`/products/${d}?iframe=true`},ne=()=>{F.value="/products/new?iframe=true"},ie=()=>{F.value="/shop/preview"},de=async()=>{B.value=!0;try{const d={subdomain:o.settings.subdomain?.toLowerCase().replace(/\s+/g,"-")||o.settings.name.toLowerCase().replace(/\s+/g,"-")||"myshop",pattern:o.currentThemeId,config:o.settings},e=await q.saveSite(d);e&&e.id&&(C.value=e.id)}catch(d){console.error(d)}finally{B.value=!1}},re=async()=>{if(C.value){I.value=!0;try{await q.publishSite(C.value),alert("Сайт успешно опубликован!")}catch(d){console.error(d),alert("Ошибка публикации")}finally{I.value=!1}}},H=()=>{T.value&&(T.value.src=T.value.src)},G=K({props:{modelValue:{type:String,default:"#000000"}},emits:["update:modelValue"],setup(d,{emit:e}){return()=>M("div",{class:"d-flex align-center border rounded pa-2 cursor-pointer"},[M("input",{type:"color",value:d.modelValue,onInput:t=>e("update:modelValue",t.target.value),style:"width: 32px; height: 32px; border: none; cursor: pointer; border-radius: 4px;"}),M("span",{class:"text-body-2 ml-3"},d.modelValue.toUpperCase())])}});return(d,e)=>(u(),c(ue,null,{default:a(()=>[n("div",Ve,[n("div",ke,[l(r,{icon:"mdi-arrow-left",variant:"text",to:"/themes",class:"mr-2"}),n("h1",Ce,"Редактор: "+g(s(o).currentTheme?.name),1),l(U,{size:"x-small",color:"green",class:"ml-3 font-weight-bold",label:""},{default:a(()=>[...e[26]||(e[26]=[i("Live",-1)])]),_:1})]),n("div",Te,[l(r,{variant:"outlined",class:"text-none font-weight-bold",rounded:"lg",onClick:_},{default:a(()=>[...e[27]||(e[27]=[i(" Шаблоны ",-1)])]),_:1}),l(r,{color:"#37E23F",variant:"flat",class:"text-white text-none font-weight-bold px-6",rounded:"lg",onClick:de,loading:B.value},{default:a(()=>[...e[28]||(e[28]=[i(" Сохранить ",-1)])]),_:1},8,["loading"]),C.value?(u(),c(r,{key:0,color:"blue",variant:"flat",class:"text-white text-none font-weight-bold px-6",rounded:"lg",onClick:re,loading:I.value},{default:a(()=>[...e[29]||(e[29]=[i(" Опубликовать ",-1)])]),_:1},8,["loading"])):h("",!0)])]),l(z,{class:"mb-0"}),n("div",Fe,[n("div",Se,[l(ve,{flat:"",variant:"accordion",multiple:"",modelValue:O.value,"onUpdate:modelValue":e[21]||(e[21]=t=>O.value=t)},{default:a(()=>[l(b,{value:"products"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[30]||(e[30]=[i("Товары",-1)])]),_:1}),l(f,null,{default:a(()=>[l(r,{block:"",color:"#2A1A8E",class:"text-none text-white mb-4","prepend-icon":"mdi-plus",onClick:ne},{default:a(()=>[...e[31]||(e[31]=[i(" Добавить товар ",-1)])]),_:1}),(u(!0),V(L,null,A(oe.value,t=>(u(),V("div",{key:t.id,onClick:S=>se(t.id),class:"d-flex align-center pa-2 border rounded mb-2 hover-bg cursor-pointer"},[l(ye,{size:"40",color:"grey-lighten-2",rounded:""},{default:a(()=>[l(X,{icon:"mdi-tshirt-crew",color:"grey"})]),_:1}),n("div",he,[n("div",ze,g(t.name),1),n("div",Ae,g(t.price)+" ₽",1)]),l(j),l(r,{icon:"",variant:"text",size:"x-small",color:"grey"},{default:a(()=>[l(X,null,{default:a(()=>[...e[32]||(e[32]=[i("mdi-pencil",-1)])]),_:1})]),_:1})],8,Ue))),128)),l(r,{variant:"text",size:"small",block:"",class:"text-none text-grey mt-2",onClick:ie},{default:a(()=>[...e[33]||(e[33]=[i(" Вернуться к просмотру сайта ",-1)])]),_:1})]),_:1})]),_:1}),l(b,{value:"general"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[34]||(e[34]=[i("Общие настройки",-1)])]),_:1}),l(f,null,{default:a(()=>[e[35]||(e[35]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Название магазина",-1)),l(p,{modelValue:s(o).settings.name,"onUpdate:modelValue":e[0]||(e[0]=t=>s(o).settings.name=t),variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),e[36]||(e[36]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Поддомен (URL сайта)",-1)),l(p,{modelValue:s(o).settings.subdomain,"onUpdate:modelValue":e[1]||(e[1]=t=>s(o).settings.subdomain=t),variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4",suffix:".myshop.com",placeholder:"example"},null,8,["modelValue"]),e[37]||(e[37]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"URL логотипа",-1)),l(p,{modelValue:s(o).settings.logoUrl,"onUpdate:modelValue":e[2]||(e[2]=t=>s(o).settings.logoUrl=t),placeholder:"https://...",variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4"},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{value:"colors"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[38]||(e[38]=[i("Цвета",-1)])]),_:1}),l(f,null,{default:a(()=>[e[44]||(e[44]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Основной цвет",-1)),l(s(G),{modelValue:s(o).settings.primaryColor,"onUpdate:modelValue":e[3]||(e[3]=t=>s(o).settings.primaryColor=t),class:"mb-4"},null,8,["modelValue"]),e[45]||(e[45]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Вторичный цвет",-1)),l(s(G),{modelValue:s(o).settings.secondaryColor,"onUpdate:modelValue":e[4]||(e[4]=t=>s(o).settings.secondaryColor=t),class:"mb-4"},null,8,["modelValue"]),e[46]||(e[46]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Цвет фона",-1)),l(E,{modelValue:s(o).settings.backgroundColor,"onUpdate:modelValue":e[5]||(e[5]=t=>s(o).settings.backgroundColor=t),mandatory:"",class:"flex-wrap mb-4"},{default:a(()=>[l(r,{value:"#FFFFFF",size:"small",class:"rounded-lg"},{default:a(()=>[l(P,{width:"20",height:"20",color:"#FFFFFF",rounded:"circle",class:"border mr-1"}),e[39]||(e[39]=i(" Белый ",-1))]),_:1}),l(r,{value:"#FAFAFA",size:"small",class:"rounded-lg"},{default:a(()=>[l(P,{width:"20",height:"20",color:"#FAFAFA",rounded:"circle",class:"border mr-1"}),e[40]||(e[40]=i(" Серый ",-1))]),_:1}),l(r,{value:"#121212",size:"small",class:"rounded-lg"},{default:a(()=>[l(P,{width:"20",height:"20",color:"#121212",rounded:"circle",class:"border mr-1"}),e[41]||(e[41]=i(" Тёмный ",-1))]),_:1})]),_:1},8,["modelValue"]),e[47]||(e[47]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Цвет текста",-1)),l(E,{modelValue:s(o).settings.textColor,"onUpdate:modelValue":e[6]||(e[6]=t=>s(o).settings.textColor=t),mandatory:""},{default:a(()=>[l(r,{value:"#212121",size:"small"},{default:a(()=>[...e[42]||(e[42]=[i("Тёмный",-1)])]),_:1}),l(r,{value:"#FFFFFF",size:"small"},{default:a(()=>[...e[43]||(e[43]=[i("Светлый",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(b,{value:"hero"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[48]||(e[48]=[i("Баннер на главной",-1)])]),_:1}),l(f,null,{default:a(()=>[e[52]||(e[52]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Заголовок",-1)),l(R,{modelValue:s(o).settings.heroTitle,"onUpdate:modelValue":e[7]||(e[7]=t=>s(o).settings.heroTitle=t),variant:"outlined",density:"compact",rows:"2","auto-grow":"","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),e[53]||(e[53]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Подзаголовок",-1)),l(R,{modelValue:s(o).settings.heroSubtitle,"onUpdate:modelValue":e[8]||(e[8]=t=>s(o).settings.heroSubtitle=t),variant:"outlined",density:"compact",rows:"2","auto-grow":"","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),e[54]||(e[54]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Текст кнопки",-1)),l(p,{modelValue:s(o).settings.heroButtonText,"onUpdate:modelValue":e[9]||(e[9]=t=>s(o).settings.heroButtonText=t),variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),e[55]||(e[55]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Расположение",-1)),l(E,{modelValue:s(o).settings.heroStyle,"onUpdate:modelValue":e[10]||(e[10]=t=>s(o).settings.heroStyle=t),mandatory:"",class:"mb-4"},{default:a(()=>[l(r,{value:"left",size:"small"},{default:a(()=>[...e[49]||(e[49]=[i("Слева",-1)])]),_:1}),l(r,{value:"centered",size:"small"},{default:a(()=>[...e[50]||(e[50]=[i("Центр",-1)])]),_:1}),l(r,{value:"right",size:"small"},{default:a(()=>[...e[51]||(e[51]=[i("Справа",-1)])]),_:1})]),_:1},8,["modelValue"]),e[56]||(e[56]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Фоновое изображение (URL)",-1)),l(p,{modelValue:s(o).settings.heroImage,"onUpdate:modelValue":e[11]||(e[11]=t=>s(o).settings.heroImage=t),placeholder:"https://...",variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),l($,{modelValue:s(o).settings.heroOverlay,"onUpdate:modelValue":e[12]||(e[12]=t=>s(o).settings.heroOverlay=t),label:"Затемнение поверх фото",color:"#4527A0",density:"compact","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1}),l(b,{value:"sections"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[57]||(e[57]=[i("Секции страницы",-1)])]),_:1}),l(f,null,{default:a(()=>[l($,{modelValue:s(o).settings.showProductsSection,"onUpdate:modelValue":e[13]||(e[13]=t=>s(o).settings.showProductsSection=t),label:"Показывать товары",color:"#4527A0",density:"compact","hide-details":"",class:"mb-2"},null,8,["modelValue"]),s(o).settings.showProductsSection?(u(),c(p,{key:0,modelValue:s(o).settings.productsTitle,"onUpdate:modelValue":e[14]||(e[14]=t=>s(o).settings.productsTitle=t),label:"Заголовок секции товаров",variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4"},null,8,["modelValue"])):h("",!0),l($,{modelValue:s(o).settings.showAboutSection,"onUpdate:modelValue":e[15]||(e[15]=t=>s(o).settings.showAboutSection=t),label:"Секция 'О нас'",color:"#4527A0",density:"compact","hide-details":"",class:"mb-2"},null,8,["modelValue"]),s(o).settings.showAboutSection?(u(),c(R,{key:1,modelValue:s(o).settings.aboutText,"onUpdate:modelValue":e[16]||(e[16]=t=>s(o).settings.aboutText=t),label:"Текст о магазине",variant:"outlined",density:"compact",rows:"3","hide-details":""},null,8,["modelValue"])):h("",!0)]),_:1})]),_:1}),l(b,{value:"catalog"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[58]||(e[58]=[i("Каталог и Карточки",-1)])]),_:1}),l(f,null,{default:a(()=>[e[59]||(e[59]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Стиль карточек товара",-1)),l(be,{modelValue:s(o).settings.cardLayout,"onUpdate:modelValue":e[17]||(e[17]=t=>s(o).settings.cardLayout=t),"hide-details":"",class:"mb-2"},{default:a(()=>[l(D,{value:"grid-standard",label:"Стандартная сетка",density:"compact"}),l(D,{value:"grid-compact",label:"Компактная сетка",density:"compact"}),l(D,{value:"list-view",label:"Список (в строку)",density:"compact"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(b,{value:"footer"},{default:a(()=>[l(v,{class:"font-weight-bold"},{default:a(()=>[...e[60]||(e[60]=[i("Футер",-1)])]),_:1}),l(f,null,{default:a(()=>[e[61]||(e[61]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Текст футера",-1)),l(p,{modelValue:s(o).settings.footerText,"onUpdate:modelValue":e[18]||(e[18]=t=>s(o).settings.footerText=t),variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4"},null,8,["modelValue"]),e[62]||(e[62]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Telegram",-1)),l(p,{modelValue:s(o).settings.socialLinks.telegram,"onUpdate:modelValue":e[19]||(e[19]=t=>s(o).settings.socialLinks.telegram=t),placeholder:"@username или ссылка",variant:"outlined",density:"compact","hide-details":"auto",class:"mb-4","prepend-inner-icon":"mdi-send"},null,8,["modelValue"]),e[63]||(e[63]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-1 d-block"},"Instagram",-1)),l(p,{modelValue:s(o).settings.socialLinks.instagram,"onUpdate:modelValue":e[20]||(e[20]=t=>s(o).settings.socialLinks.instagram=t),placeholder:"@username",variant:"outlined",density:"compact","hide-details":"auto","prepend-inner-icon":"mdi-instagram"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),n("div",Le,[l(P,{elevation:"2",rounded:"pill",height:"48",class:"d-flex align-center px-2 mb-4",style:{position:"absolute",top:"16px","z-index":"10"}},{default:a(()=>[l(r,{variant:"text",size:"small",icon:"mdi-monitor",color:x.value==="desktop"?"black":"grey",onClick:e[22]||(e[22]=t=>x.value="desktop")},null,8,["color"]),l(r,{variant:"text",size:"small",icon:"mdi-cellphone",color:x.value==="mobile"?"black":"grey",onClick:e[23]||(e[23]=t=>x.value="mobile")},null,8,["color"]),l(z,{vertical:"",class:"mx-2 my-2"}),l(r,{variant:"text",size:"small",icon:"mdi-refresh",color:"grey-darken-2",onClick:H}),l(z,{vertical:"",class:"mx-2 my-2"}),l(r,{variant:"text",size:"small",icon:"mdi-open-in-new",color:"grey-darken-2",href:"/shop/preview",target:"_blank"})]),_:1}),n("div",{class:N(["preview-container bg-white elevation-5 transition-all",x.value==="mobile"?"mobile-view rounded-xl":"desktop-view rounded-lg"])},[n("iframe",{id:"store-preview",src:F.value,frameborder:"0",class:"w-100 h-100",ref_key:"previewFrame",ref:T},null,8,Pe)],2)])]),l(xe,{modelValue:y.value,"onUpdate:modelValue":e[25]||(e[25]=t=>y.value=t),"max-width":"1200",scrollable:""},{default:a(()=>[l(Q,{class:"rounded-xl h-100",style:{"max-height":"90vh"}},{default:a(()=>[l(fe,{class:"d-flex align-center pa-4 text-h5 font-weight-bold"},{default:a(()=>[e[64]||(e[64]=i(" Выберите шаблон ",-1)),l(j),l(r,{icon:"mdi-close",variant:"text",onClick:e[24]||(e[24]=t=>y.value=!1)})]),_:1}),l(z),l(W,{class:"pa-6 bg-grey-lighten-5"},{default:a(()=>[n("div",Be,[(u(),V(L,null,A(Y,t=>l(U,{key:t.value,color:w.value===t.value?"#4527A0":"grey-lighten-3",class:N([w.value===t.value?"text-white":"text-grey-darken-2","font-weight-bold cursor-pointer"]),onClick:S=>w.value=t.value},{default:a(()=>[i(g(t.label),1)]),_:2},1032,["color","class","onClick"])),64))]),l(ce,null,{default:a(()=>[(u(!0),V(L,null,A(Z.value,t=>(u(),c(we,{key:t.id,cols:"12",sm:"6",lg:"4"},{default:a(()=>[l(Q,{class:N(["rounded-xl h-100 template-card cursor-pointer",{selected:s(o).currentThemeId===t.id}]),flat:"",onClick:S=>ee(t.id)},{default:a(()=>[n("div",{class:"template-preview d-flex flex-column",style:k(ae(t))},[n("div",{class:"preview-header d-flex align-center px-4 py-2",style:k({backgroundColor:t.settings.primaryColor})},[e[65]||(e[65]=n("div",{class:"preview-logo"},null,-1)),l(j),e[66]||(e[66]=n("div",{class:"preview-nav d-flex gap-2"},[n("div",{class:"preview-nav-item"}),n("div",{class:"preview-nav-item"}),n("div",{class:"preview-nav-item"})],-1))],4),n("div",Ie,[n("div",{class:"preview-title",style:k({color:t.settings.textColor})},g(t.settings.heroTitle),5),n("div",{class:"preview-subtitle",style:k({color:t.settings.textColor,opacity:.7})},g(t.settings.heroSubtitle),5),n("div",{class:"preview-button mt-3",style:k({backgroundColor:t.settings.primaryColor})},null,4)]),n("div",Ee,[(u(),V(L,null,A(3,S=>n("div",{class:"preview-product",key:S})),64))]),s(o).currentThemeId===t.id?(u(),c(U,{key:0,color:"green",size:"small",class:"selected-badge","prepend-icon":"mdi-check"},{default:a(()=>[...e[67]||(e[67]=[i(" Активен ",-1)])]),_:1})):h("",!0)],4),l(W,{class:"pa-4"},{default:a(()=>[n("div",Re,[n("h3",$e,g(t.name),1),l(U,{size:"x-small",color:le(t.category),class:"ml-2",label:""},{default:a(()=>[i(g(te(t.category)),1)]),_:2},1032,["color"])]),n("p",De,g(t.description),1)]),_:2},1024)]),_:2},1032,["class","onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),Je=ge(Ne,[["__scopeId","data-v-f218699a"]]);export{Je as default};
