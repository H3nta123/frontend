import{u as Q,S as R}from"./ShopLayout-BNRZgYQN.js";import{a as q,u as E,_ as H}from"./_plugin-vue_export-helper-C_lUuKz4.js";import{d as J,F as C,m as f,B as K,c,w as l,a,b as s,ac as d,y as u,ae as Z,e as T,f as A,n as w,t as L,a7 as G,h as B,g as v,s as k,K as W,C as h,I as X,J as Y,V as ee,ai as te,o as i,j as U,x as j,Z as $,H as le,P as ae,Q as oe}from"./index-BaQgaqTq.js";const se={class:"d-flex justify-space-between align-center mb-8"},re={class:"mb-4"},ie={class:"d-flex gap-2"},ne={key:0,class:"d-flex justify-center py-16"},ce={class:"d-flex align-center"},de={key:0,class:"text-body-2 text-decoration-line-through text-grey ml-2"},ue={class:"d-flex flex-column flex-grow-1 px-6 py-4 h-100 justify-center"},me={class:"text-body-2 text-grey mb-4 text-truncate",style:{"max-width":"400px"}},fe={class:"d-flex align-center"},ve={key:0,class:"text-body-2 text-decoration-line-through text-grey ml-2"},ge={class:"pa-4 d-flex align-center h-100"},ye=J({__name:"CatalogView",setup(pe){const z=q(),F=E(),N=Q(),r=C(()=>z.settings),m=C(()=>z.isDarkTheme),V=f(!0),g=f(""),y=f(null),p=f(null),x=f(!1),b=f("default"),M=[{title:"По умолчанию",value:"default"},{title:"Сначала дешёвые",value:"price_asc"},{title:"Сначала дорогие",value:"price_desc"},{title:"По названию",value:"name"}],P=C(()=>{switch(r.value.cardLayout){case"grid-compact":return{cols:6,sm:4,lg:3};case"list-view":return{cols:12,sm:12,lg:12};default:return{cols:12,sm:6,lg:4}}});K(async()=>{V.value=!0,await F.fetchProducts(),V.value=!1});const S=C(()=>{let o=[...F.products];if(g.value){const t=g.value.toLowerCase();o=o.filter(n=>n.name.toLowerCase().includes(t)||n.description?.toLowerCase().includes(t))}switch(y.value&&(o=o.filter(t=>t.price>=y.value)),p.value&&(o=o.filter(t=>t.price<=p.value)),x.value&&(o=o.filter(t=>t.status==="active")),b.value){case"price_asc":o.sort((t,n)=>t.price-n.price);break;case"price_desc":o.sort((t,n)=>n.price-t.price);break;case"name":o.sort((t,n)=>t.name.localeCompare(n.name));break}return o}),_=o=>new Intl.NumberFormat("ru-RU").format(o)+" ₽",I=o=>{N.addItem({id:o.id,name:o.name,price:o.price,image:o.images?.[0]})},D=()=>{g.value="",y.value=null,p.value=null,x.value=!1,b.value="default"};return(o,t)=>{const n=te("router-link");return i(),c(R,null,{default:l(()=>[a(ee,{class:"py-8 mw-1200"},{default:l(()=>[s("div",se,[s("div",null,[s("h1",{class:"text-h4 font-weight-bold",style:d({color:r.value.textColor})}," Каталог ",4),s("p",{class:"text-body-2 mt-1",style:d({color:r.value.textColor,opacity:.7})},u(S.value.length)+" товаров ",5)]),a(Z,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=e=>b.value=e),items:M,"item-title":"title","item-value":"value",variant:"outlined",density:"compact","hide-details":"",style:{"max-width":"200px"}},null,8,["modelValue"])]),a(T,null,{default:l(()=>[a(A,{cols:"12",md:"3"},{default:l(()=>[a(w,{class:"rounded-xl pa-4",flat:"",color:m.value?"grey-darken-4":"grey-lighten-5"},{default:l(()=>[s("h3",{class:"text-body-1 font-weight-bold mb-4",style:d({color:r.value.textColor})},"Фильтры",4),a(L,{modelValue:g.value,"onUpdate:modelValue":t[1]||(t[1]=e=>g.value=e),placeholder:"Поиск...",variant:"outlined",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",class:"mb-4"},null,8,["modelValue"]),s("div",re,[s("label",{class:"text-caption font-weight-bold mb-2 d-block",style:d({color:r.value.textColor})}," Цена ",4),s("div",ie,[a(L,{modelValue:y.value,"onUpdate:modelValue":t[2]||(t[2]=e=>y.value=e),modelModifiers:{number:!0},placeholder:"От",type:"number",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"]),a(L,{modelValue:p.value,"onUpdate:modelValue":t[3]||(t[3]=e=>p.value=e),modelModifiers:{number:!0},placeholder:"До",type:"number",variant:"outlined",density:"compact","hide-details":""},null,8,["modelValue"])])]),a(G,{modelValue:x.value,"onUpdate:modelValue":t[4]||(t[4]=e=>x.value=e),label:"Только в наличии",color:r.value.primaryColor,density:"compact","hide-details":""},null,8,["modelValue","color"]),a(B,{block:"",variant:"text",class:"text-none mt-4",onClick:D},{default:l(()=>[...t[5]||(t[5]=[v(" Сбросить фильтры ",-1)])]),_:1})]),_:1},8,["color"])]),_:1}),a(A,{cols:"12",md:"9"},{default:l(()=>[V.value?(i(),k("div",ne,[a(W,{indeterminate:"",color:r.value.primaryColor,size:"48"},null,8,["color"])])):S.value.length===0?(i(),c(w,{key:1,class:"rounded-xl pa-12 text-center",flat:"",color:m.value?"grey-darken-4":"grey-lighten-5"},{default:l(()=>[a(h,{icon:"mdi-magnify-close",size:"64",color:"grey",class:"mb-4"}),s("h3",{class:"text-h6 font-weight-bold mb-2",style:d({color:r.value.textColor})}," Ничего не найдено ",4),s("p",{class:"text-body-2",style:d({color:r.value.textColor,opacity:.7})}," Попробуйте изменить параметры поиска ",4)]),_:1},8,["color"])):(i(),c(T,{key:2},{default:l(()=>[(i(!0),k(Y,null,X(S.value,e=>(i(),c(A,{key:e.id,cols:P.value.cols,sm:P.value.sm,lg:P.value.lg},{default:l(()=>[r.value.cardLayout!=="list-view"?(i(),c(w,{key:0,class:"rounded-xl product-card h-100 d-flex flex-column",flat:""},{default:l(()=>[a(n,{to:`/shop/product/${e.id}`,class:"text-decoration-none"},{default:l(()=>[a(U,{color:m.value?"grey-darken-3":"grey-lighten-4",height:r.value.cardLayout==="grid-compact"?180:220,class:"rounded-xl d-flex align-center justify-center position-relative"},{default:l(()=>[e.images&&e.images.length>0?(i(),c($,{key:0,src:e.images[0],height:r.value.cardLayout==="grid-compact"?180:220,cover:"",class:"rounded-xl"},null,8,["src","height"])):(i(),c(h,{key:1,size:"64",color:m.value?"grey-darken-1":"grey-lighten-2"},{default:l(()=>[...t[6]||(t[6]=[v(" mdi-tshirt-crew-outline ",-1)])]),_:1},8,["color"])),e.compareAtPrice&&e.compareAtPrice>e.price?(i(),c(le,{key:2,color:"red",size:"small",class:"position-absolute",style:{top:"8px",right:"8px"}},{default:l(()=>[v(" -"+u(Math.round((1-e.price/e.compareAtPrice)*100))+"% ",1)]),_:2},1024)):j("",!0)]),_:2},1032,["color","height"])]),_:2},1032,["to"]),a(ae,{class:"flex-grow-1 pa-4"},{default:l(()=>[a(n,{to:`/shop/product/${e.id}`,class:"text-decoration-none"},{default:l(()=>[s("h3",{class:"text-body-1 font-weight-bold mb-2",style:d({color:r.value.textColor})},u(e.name),5)]),_:2},1032,["to"]),s("div",ce,[s("span",{class:"text-h6 font-weight-bold",style:d({color:r.value.primaryColor})},u(_(e.price)),5),e.compareAtPrice&&e.compareAtPrice>e.price?(i(),k("span",de,u(_(e.compareAtPrice)),1)):j("",!0)])]),_:2},1024),a(oe,{class:"pa-4 pt-0"},{default:l(()=>[a(B,{block:"",color:r.value.primaryColor,variant:"flat",class:"text-white text-none font-weight-bold",rounded:"lg",disabled:e.status!=="active",onClick:O=>I(e)},{default:l(()=>[a(h,{icon:"mdi-cart-plus",class:"mr-2"}),t[7]||(t[7]=v(" В корзину ",-1))]),_:1},8,["color","disabled","onClick"])]),_:2},1024)]),_:2},1024)):(i(),c(w,{key:1,class:"rounded-xl product-card w-100 d-flex flex-row align-center",flat:"",style:{height:"160px"}},{default:l(()=>[a(n,{to:`/shop/product/${e.id}`,class:"text-decoration-none h-100"},{default:l(()=>[a(U,{color:m.value?"grey-darken-3":"grey-lighten-4",height:"100%",width:"160",class:"rounded-l-xl d-flex align-center justify-center position-relative"},{default:l(()=>[e.images&&e.images.length>0?(i(),c($,{key:0,src:e.images[0],height:"100%",cover:"",class:"rounded-l-xl"},null,8,["src"])):(i(),c(h,{key:1,size:"48",color:m.value?"grey-darken-1":"grey-lighten-2"},{default:l(()=>[...t[8]||(t[8]=[v(" mdi-tshirt-crew-outline ",-1)])]),_:1},8,["color"]))]),_:2},1032,["color"])]),_:2},1032,["to"]),s("div",ue,[a(n,{to:`/shop/product/${e.id}`,class:"text-decoration-none"},{default:l(()=>[s("h3",{class:"text-h6 font-weight-bold mb-2",style:d({color:r.value.textColor})},u(e.name),5)]),_:2},1032,["to"]),s("p",me,u(e.description||"Описание отсутствует"),1),s("div",fe,[s("span",{class:"text-h6 font-weight-bold",style:d({color:r.value.primaryColor})},u(_(e.price)),5),e.compareAtPrice&&e.compareAtPrice>e.price?(i(),k("span",ve,u(_(e.compareAtPrice)),1)):j("",!0)])]),s("div",ge,[a(B,{color:r.value.primaryColor,variant:"flat",class:"text-white text-none font-weight-bold",rounded:"lg",height:"48",width:"160",disabled:e.status!=="active",onClick:O=>I(e)},{default:l(()=>[a(h,{icon:"mdi-cart-plus",class:"mr-2"}),t[9]||(t[9]=v(" В корзину ",-1))]),_:1},8,["color","disabled","onClick"])])]),_:2},1024))]),_:2},1032,["cols","sm","lg"]))),128))]),_:1}))]),_:1})]),_:1})]),_:1})]),_:1})}}}),_e=H(ye,[["__scopeId","data-v-6205a5cf"]]);export{_e as default};
