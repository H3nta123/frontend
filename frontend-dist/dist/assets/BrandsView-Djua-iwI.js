import{M as z}from"./MainLayout-cmQcMttl.js";import{E,m as x,G as B,d as j,$ as F,B as P,c as V,w as l,b as n,s as $,a as t,g as f,h as p,v,K as R,L as G,y as k,n as U,C as D,I as J,J as K,M as O,N as A,P as T,t as I,a6 as Q,Q as S,O as N,R as L,o as g,D as Z,Z as q}from"./index-BaQgaqTq.js";import{_ as H}from"./_plugin-vue_export-helper-C_lUuKz4.js";const W=E("brands",()=>{const c=x([]),o=x(!1),d=x(null);async function b(){o.value=!0,d.value=null;try{const r=await B.get("/brands");c.value=r.data}catch(r){d.value=r.message||"Ошибка загрузки брендов",console.error("fetchBrands error:",r)}finally{o.value=!1}}async function m(r){try{return await B.get(`/brands/${r}`)}catch(i){return d.value=i.message||"Ошибка загрузки бренда",null}}async function y(r){o.value=!0,d.value=null;try{const i=await B.post("/brands",r);return c.value.push(i),i}catch(i){return d.value=i.message||"Ошибка создания бренда",null}finally{o.value=!1}}async function h(r,i){o.value=!0,d.value=null;try{const w=await B.patch(`/brands/${r}`,i),C=c.value.findIndex(u=>u.id===r);return C!==-1&&(c.value[C]=w),w}catch(w){return d.value=w.message||"Ошибка обновления бренда",null}finally{o.value=!1}}async function s(r){o.value=!0,d.value=null;try{return await B.delete(`/brands/${r}`),c.value=c.value.filter(i=>i.id!==r),!0}catch(i){return d.value=i.message||"Ошибка удаления бренда",!1}finally{o.value=!1}}return{brands:c,loading:o,error:d,fetchBrands:b,fetchBrandById:m,createBrand:y,updateBrand:h,deleteBrand:s}}),X={class:"d-flex justify-space-between align-center mb-8"},Y={key:0,class:"d-flex justify-center py-16"},_={class:"py-3 pl-6"},ee={class:"font-weight-bold text-body-1"},te={class:"text-body-2 text-grey-darken-1",style:{"max-width":"400px"}},le={class:"text-right pr-6"},ae=j({__name:"BrandsView",setup(c){const o=W(),d=x(!1),b=x(!1),m=x(null),y=x(null),h=x(""),s=F({name:"",description:"",logoUrl:""});P(()=>{o.fetchBrands()});const r=u=>{u?(m.value=u,s.name=u.name,s.description=u.description||"",s.logoUrl=u.logoUrl||""):(m.value=null,s.name="",s.description="",s.logoUrl=""),h.value="",d.value=!0},i=u=>{y.value=u,b.value=!0},w=async()=>{if(!s.name.trim()){h.value="Название обязательно";return}const u={name:s.name,description:s.description||void 0,logoUrl:s.logoUrl||void 0};let e=!1;m.value?e=!!await o.updateBrand(m.value.id,u):e=!!await o.createBrand(u),e&&(d.value=!1)},C=async()=>{if(!y.value)return;await o.deleteBrand(y.value.id)&&(b.value=!1,y.value=null)};return(u,e)=>(g(),V(z,null,{default:l(()=>[n("div",X,[e[10]||(e[10]=n("div",null,[n("h1",{class:"text-h5 font-weight-bold text-black"},"Бренды / Производители"),n("p",{class:"text-body-2 text-grey-darken-1 mt-1"},"Управление брендами товаров")],-1)),t(p,{color:"#4527A0","prepend-icon":"mdi-plus",class:"text-none text-white font-weight-bold px-6",height:"44",rounded:"lg",elevation:"0",onClick:e[0]||(e[0]=a=>r())},{default:l(()=>[...e[9]||(e[9]=[f(" Добавить бренд ",-1)])]),_:1})]),v(o).loading&&v(o).brands.length===0?(g(),$("div",Y,[t(R,{indeterminate:"",color:"#4527A0",size:"48"})])):v(o).error?(g(),V(G,{key:1,type:"error",class:"mb-4",closable:""},{default:l(()=>[f(k(v(o).error),1)]),_:1})):v(o).brands.length===0?(g(),V(U,{key:2,class:"rounded-xl border pa-12 text-center",flat:""},{default:l(()=>[t(D,{icon:"mdi-tag-multiple-outline",size:"64",color:"grey-lighten-1",class:"mb-4"}),e[12]||(e[12]=n("h3",{class:"text-h6 font-weight-bold mb-2"},"Брендов пока нет",-1)),e[13]||(e[13]=n("p",{class:"text-body-2 text-grey mb-6"},"Добавьте первый бренд для товаров",-1)),t(p,{color:"#4527A0","prepend-icon":"mdi-plus",class:"text-none text-white font-weight-bold",rounded:"lg",onClick:e[1]||(e[1]=a=>r())},{default:l(()=>[...e[11]||(e[11]=[f(" Добавить бренд ",-1)])]),_:1})]),_:1})):(g(),V(U,{key:3,class:"rounded-xl border",flat:""},{default:l(()=>[t(O,null,{default:l(()=>[e[16]||(e[16]=n("thead",{class:"bg-grey-lighten-4"},[n("tr",null,[n("th",{class:"text-left font-weight-bold py-4 pl-6"},"Логотип"),n("th",{class:"text-left font-weight-bold"},"Название"),n("th",{class:"text-left font-weight-bold"},"Описание"),n("th",{class:"text-right font-weight-bold pr-6"},"Действия")])],-1)),n("tbody",null,[(g(!0),$(K,null,J(v(o).brands,a=>(g(),$("tr",{key:a.id,class:"hover-row"},[n("td",_,[t(Z,{color:"grey-lighten-4",size:"48",rounded:"lg"},{default:l(()=>[a.logoUrl?(g(),V(q,{key:0,src:a.logoUrl,cover:""},null,8,["src"])):(g(),V(D,{key:1,icon:"mdi-tag-outline",color:"grey"}))]),_:2},1024)]),n("td",ee,k(a.name),1),n("td",te,k(a.description||"—"),1),n("td",le,[t(p,{variant:"text",color:"blue",class:"text-none font-weight-medium",onClick:M=>r(a)},{default:l(()=>[...e[14]||(e[14]=[f(" Редактировать ",-1)])]),_:1},8,["onClick"]),t(p,{variant:"text",color:"red",class:"text-none font-weight-medium",onClick:M=>i(a)},{default:l(()=>[...e[15]||(e[15]=[f(" Удалить ",-1)])]),_:1},8,["onClick"])])]))),128))])]),_:1})]),_:1})),t(L,{modelValue:d.value,"onUpdate:modelValue":e[6]||(e[6]=a=>d.value=a),"max-width":"500"},{default:l(()=>[t(U,{class:"rounded-xl"},{default:l(()=>[t(A,{class:"text-h6 font-weight-bold pa-6 pb-2"},{default:l(()=>[f(k(m.value?"Редактировать бренд":"Новый бренд"),1)]),_:1}),t(T,{class:"px-6 pb-4"},{default:l(()=>[e[17]||(e[17]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-2 d-block"},"Название *",-1)),t(I,{modelValue:s.name,"onUpdate:modelValue":e[2]||(e[2]=a=>s.name=a),placeholder:"Например, Nike",variant:"outlined",density:"comfortable","hide-details":"auto",class:"mb-4","error-messages":h.value},null,8,["modelValue","error-messages"]),e[18]||(e[18]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-2 d-block"},"Описание",-1)),t(Q,{modelValue:s.description,"onUpdate:modelValue":e[3]||(e[3]=a=>s.description=a),placeholder:"Краткое описание бренда",variant:"outlined",density:"comfortable",rows:"3","hide-details":"",class:"mb-4"},null,8,["modelValue"]),e[19]||(e[19]=n("label",{class:"text-caption font-weight-bold text-grey-darken-1 mb-2 d-block"},"URL логотипа",-1)),t(I,{modelValue:s.logoUrl,"onUpdate:modelValue":e[4]||(e[4]=a=>s.logoUrl=a),placeholder:"https://example.com/logo.png",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue"])]),_:1}),t(S,{class:"pa-6 pt-0"},{default:l(()=>[t(N),t(p,{variant:"text",class:"text-none",onClick:e[5]||(e[5]=a=>d.value=!1)},{default:l(()=>[...e[20]||(e[20]=[f("Отмена",-1)])]),_:1}),t(p,{color:"#4527A0",variant:"flat",class:"text-none font-weight-bold text-white",rounded:"lg",loading:v(o).loading,onClick:w},{default:l(()=>[f(k(m.value?"Сохранить":"Создать"),1)]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(L,{modelValue:b.value,"onUpdate:modelValue":e[8]||(e[8]=a=>b.value=a),"max-width":"400"},{default:l(()=>[t(U,{class:"rounded-xl"},{default:l(()=>[t(A,{class:"text-h6 font-weight-bold pa-6 pb-2"},{default:l(()=>[...e[21]||(e[21]=[f(" Удалить бренд? ",-1)])]),_:1}),t(T,{class:"px-6 pb-4"},{default:l(()=>[e[22]||(e[22]=f(" Вы уверены, что хотите удалить бренд ",-1)),n("strong",null,k(y.value?.name),1),e[23]||(e[23]=f("? ",-1))]),_:1}),t(S,{class:"pa-6 pt-0"},{default:l(()=>[t(N),t(p,{variant:"text",class:"text-none",onClick:e[7]||(e[7]=a=>b.value=!1)},{default:l(()=>[...e[24]||(e[24]=[f("Отмена",-1)])]),_:1}),t(p,{color:"red",variant:"flat",class:"text-none font-weight-bold",rounded:"lg",loading:v(o).loading,onClick:C},{default:l(()=>[...e[25]||(e[25]=[f(" Удалить ",-1)])]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}}),re=H(ae,[["__scopeId","data-v-63f008d0"]]);export{re as default};
